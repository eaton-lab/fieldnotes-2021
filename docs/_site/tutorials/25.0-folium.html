

<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
    
<!-- how to read page -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

<!-- icons -->
<link rel="icon" href="/assets/images/favicon.ico">

<!-- get title from page meta -->
<title>visualization &#8211; Fieldnotes-2021</title>


<!-- store meta info on page -->





<!-- Store full web url -->

<link rel="canonical" href="
	
	
		/tutorials/25.0-folium.html
	
">


<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="/assets/css/custom.css">
<link rel="stylesheet" href="/assets/css/syntax.css">
</head>


<body id="default">

    <header>
	    

<!-- NAVBAR (DARK) -->
<nav class="navbar navbar-expand-sm navbar-dark bg-dark">

    <a class="navbar-brand" href="">Fieldnotes-2021</a>

    <!-- The toggle switch for collapsed navbar-->
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Make collapsable -->
    <div class="collapse navbar-collapse" id="navbarCollapse">

        <!-- The elements of the navbar -->
        <ul class="navbar-nav">
            

                <li class="nav-item dropdown mr-3">

                    <!-- if item has subitems -->
                    
                        <a class="nav-link" href=/>Home</a>
                    
                </li>
            

                <li class="nav-item dropdown mr-3">

                    <!-- if item has subitems -->
                    

                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Itinerary</a>
                        
                        <div class="dropdown-menu">
                        
                            
                                <a class="dropdown-item" href="/pages/expedition-2.html">Day 2 (Shimian to Xinduqiao)</a>
                            
                        
                            
                                <a class="dropdown-item" href="/pages/expedition-3.html">Day 3 (Xinduqiao to Litang)</a>
                            
                        
                            
                                <a class="dropdown-item" href="/pages/expedition-4.html">Day 4 (Litang to Litang)</a>
                            
                        
                            
                                <a class="dropdown-item" href="/pages/expedition-5.html">Day 5 (Litang to Bamei)</a>
                            
                        
                            
                                <a class="dropdown-item" href="">Day 6 (Dawu to Luhuo)</a>
                            
                        
                            
                                <a class="dropdown-item" href="">Day 7 (Luhuo to Wengdaxiang)</a>
                            
                        
                            
                                <a class="dropdown-item" href="">Day 8 (Wengdaxiang to Zamtang)</a>
                            
                        
                        </div>

                    <!-- open link in new window -->
                    
                </li>
            

                <li class="nav-item dropdown mr-3">

                    <!-- if item has subitems -->
                    
                        <a class="nav-link" href=/pages/assignments.html>Methods</a>
                    
                </li>
            
            <!-- LINK TO HOME -->
            <li class="nav-item mr-3">

        </ul>
    </div>
</nav>
  
	    


<!-- Splash header about the news -->
<div class="jumbotron" style="background-image: url(/assets/images/hackers-1.jpg);">
    <!-- <div class="mb-3 mt-0"><img src="/assets/images/E3B-logo.png"></div> -->
    <!-- <h1 class="display-5 font-italic">visualization</h1> -->
    <!-- <p class="lead mt-3 mb-0"><i></i></p> -->
</div>
    </header>

    <main role="main" class="container-md">
    	<div class="col-sm-10 mx-auto">
		    <style>
h2 {
    margin-top: 30px;
}
h3 {
    margin-top: 30px;
}
pre {
    line-height: 1.25em;
}
pre code {
    font-size: 0.9em;
}
div {
  margin-bottom: 10px;
}
</style>

<h2 id="crash-course-in-plotting-for-the-web">Crash course in plotting for the web</h2>

<p>At this point your Python coding skills should be sufficient to be able to 
follow instructions from a tutorial to generate plots from a Python plotting
library, like matplotlib or toyplot. However, many of the most powerful 
modern plotting libraries these days are web-based, meaning that they use
the visual rendering power of a web-browser to display graphics, and the 
interactive features of JavaScript (the language of web-browsers) to 
interactively style, modify, animate, or create graphics.</p>

<p>Because these web-based visualizations are so powerful, people have developed
many packages in more common coding languages to act as a wrapper
to write the web-based code to create these visualizations, but using the 
language syntax you are more familiar with, such as Python or R. This is 
the basis for libraries like <code class="language-plaintext highlighter-rouge">toyplot</code>, <code class="language-plaintext highlighter-rouge">altair</code>, <code class="language-plaintext highlighter-rouge">bokeh</code>, <code class="language-plaintext highlighter-rouge">folium</code>, etc., 
basically, most of the modern plotting libraries created in the last 5 or 
so years.</p>

<h3 id="html-css-javascript">HTML, CSS, JavaScript</h3>
<p>Oh no, do I need to learn another language? Well, actually its 3 more 
languages! But don’t worry, you don’t need to have a perfect understanding 
of HTML, CSS, or JavaScript to be able to understand how these plots work.
In the last tutorial you were introduced to the concept of <code class="language-plaintext highlighter-rouge">rasters</code> and 
<code class="language-plaintext highlighter-rouge">vectors</code> as two different methods for creating images. Moreover, we learned
the structure of an HTML document, which optionally/usually includes 
CSS and JS nested within its structure to style and add components and 
interactivity. We ended with an example plot from the <code class="language-plaintext highlighter-rouge">altair</code> library, 
which creates entire plots by using the <code class="language-plaintext highlighter-rouge">JS</code> package <code class="language-plaintext highlighter-rouge">vega</code> to insert
SVG vector elements into a single <code class="language-plaintext highlighter-rouge">div</code> container in the javascript 
<code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> section of the document, like below.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    ... CSS or JS library links go here
  <span class="nt">&lt;/head&gt;</span>

  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div&gt;</span>content<span class="nt">&lt;/div&gt;</span>
  
    <span class="nt">&lt;script&gt;</span>
      <span class="p">...</span> <span class="nx">javascript</span> <span class="nx">code</span> <span class="nx">goes</span> <span class="nx">here</span>
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>For now, this is as much as we need to know about HTML/CSS/JS. We can recycle
this general design over and over again to create all sort of interesting 
documents. Just as the <code class="language-plaintext highlighter-rouge">altair</code> package automates filling the <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> 
section based on a set of input Python code, several other Python libraries
exist to fill describe JS scripts to generate interesting plots. The one
we will learn about next is called <code class="language-plaintext highlighter-rouge">folium</code>, and is used to generate maps and
other types of geospatial visualizations based on the <code class="language-plaintext highlighter-rouge">JS</code> library <code class="language-plaintext highlighter-rouge">leaflet</code>. 
We will use this library to begin
to learn more about geographical visualizations, which is a great topic for
diving deeper into the concept of rasters and vectors.</p>

<h3 id="leaflet-map">Leaflet map</h3>
<p>Let’s start by looking at a fully-fledged example of a Leaflet map. 
As you can see, it is just another example of this HTML/CSS/JS
framework we have seen previously. The main HTML component is a <code class="language-plaintext highlighter-rouge">div</code> element
with <code class="language-plaintext highlighter-rouge">id='map'</code>. CSS is only used to set the map to fill the entire page body
element (e.g., height=100%). The rest of the work is done by the JS
<code class="language-plaintext highlighter-rouge">leaflet</code> package in the script section. This fetches tile images from 
the openstreetmap REST API, and in this case also includes a marker with 
instructions for a popup when clicked.</p>

<p>Writing or modifying the JS part of this map would not be very difficult once
you learn the structure of it, and so that is what <code class="language-plaintext highlighter-rouge">folium</code> was developed for,
to provide a Python library to generate <code class="language-plaintext highlighter-rouge">leaflet</code> maps from a set of Python
instructions.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Name of Page<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"link-to-javascript-library-online.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">src=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"link-to-css-stylesheet.css"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    
    <span class="c">&lt;!-- comment: additional styles not in CSS stylesheet added here.--&gt;</span>
    <span class="nt">&lt;style&gt;</span>
      <span class="nt">body</span> <span class="p">{</span><span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">}</span><span class="o">;</span>
      <span class="nf">#map</span> <span class="p">{</span><span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">}</span><span class="o">;</span>
    <span class="nt">&lt;/style&gt;</span>

    <span class="c">&lt;!-- the map element --&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"map"</span><span class="nt">&gt;&lt;/div&gt;</span>

    <span class="c">&lt;!-- the "map" object is defined using javascript here --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
      <span class="kd">var</span> <span class="nx">endPointLocation</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="mf">40.7401</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.9891</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nb">Map</span><span class="p">(</span><span class="dl">"</span><span class="s2">map</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">center</span><span class="p">:</span> <span class="nx">endPointLocation</span><span class="p">,</span>
        <span class="na">zoom</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
        <span class="na">layers</span><span class="p">:</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">TileLayer</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://tile.openstreetmap.org/{z}/{x}/{y}.png</span><span class="dl">"</span><span class="p">)</span>
      <span class="p">});</span>
      <span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">Marker</span><span class="p">(</span><span class="nx">endPointLocation</span><span class="p">);</span>
      <span class="nx">marker</span><span class="p">.</span><span class="nx">bindPopup</span><span class="p">(</span><span class="dl">"</span><span class="s2">End Point Corporation</span><span class="dl">"</span><span class="p">);</span>
      <span class="nx">map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
    <span class="nt">&lt;/script&gt;</span>

  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<h3 id="a-simple-folium-map">A simple folium Map</h3>
<p>The main class object in <code class="language-plaintext highlighter-rouge">folium</code> is Map. The typical workflow is to init an 
instance of this class with a set of optional arguments, and then to add 
additional marker types to it after it is initialized by using either the Map
object’s <code class="language-plaintext highlighter-rouge">.add_child()</code> function, or the <code class="language-plaintext highlighter-rouge">add_to()</code> function of other objects
that can act as children of a Map.</p>

<p>This concept of parent and child objects relates to the structure of the 
underlying code which is stored in a markup language. Remember, markup follows
a set of tags (&lt;html&gt;…&lt;/html&gt;) nested within other tags. Thus, the map 
object is the outermost tag (&lt;div id=map&gt;…&lt;/div&gt;), and other objects such 
as points that we want to appear on the map will be nested within the map id 
tag. In the <code class="language-plaintext highlighter-rouge">leaflet</code> JS code above you can see the structure is very similar,
and uses the call <code class="language-plaintext highlighter-rouge">addLayer</code> instead of <code class="language-plaintext highlighter-rouge">add_child</code>. In the folium syntax,
nested objects are referred to as children, or they can be children of its 
children, etc.</p>

<p>I tend to call my map instance variables something like <code class="language-plaintext highlighter-rouge">fmap</code>, since <code class="language-plaintext highlighter-rouge">map</code> 
is a reserved function name from the Python builtins. Here is a simple example
map generated by setting a center position in latitude longitude coordinates
and a zoom level.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">folium</span>
<span class="n">fmap</span> <span class="o">=</span> <span class="n">folium</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">fmap</span>
</code></pre></div></div>

<div>
<iframe style="display: block; margin: auto; width:100%; height:400px; margin-top:2%;" src="./images/folium-0.html">
</iframe>
</div>

<p>Here is a slightly more complex example, which re-creates exactly the 
instructions in the JS example from above. In this case we set the name of the
tile set to use (more on this below), and we add a Marker, which appears as an
icon on the map at the specified coordinates. You can zoom in or out and the 
icon will remain visible. It also includes a popup that will appear when clicked.</p>

<p>You can see that I create the <code class="language-plaintext highlighter-rouge">marker</code> class instance as a separate object, and
then add it to the existing map by using the <code class="language-plaintext highlighter-rouge">.add_child</code> function call.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">folium</span>
<span class="n">location</span> <span class="o">=</span> <span class="p">[</span><span class="mf">40.7401</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.9891</span><span class="p">]</span>
<span class="n">fmap</span> <span class="o">=</span> <span class="n">folium</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">tiles</span><span class="o">=</span><span class="s">"openstreetmap"</span><span class="p">)</span>
<span class="n">marker</span> <span class="o">=</span> <span class="n">folium</span><span class="p">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="s">"End Point Corporation"</span><span class="p">)</span>
<span class="n">fmap</span><span class="p">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>
<span class="n">fmap</span>
</code></pre></div></div>

<div>
<iframe style="display: block; margin: auto; width:100%; height:400px; margin-top:2%;" src="./images/folium-1.html">
</iframe>
</div>

<p>This could also be written another way, by using the <code class="language-plaintext highlighter-rouge">add_to()</code> function of
an object to set it as the child of some parent. This has the same effect as
above. In this case I think this way is a bit easier to read, but it depends
on the example.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">folium</span>
<span class="n">location</span> <span class="o">=</span> <span class="p">[</span><span class="mf">40.7401</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.9891</span><span class="p">]</span>
<span class="n">fmap</span> <span class="o">=</span> <span class="n">folium</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">tiles</span><span class="o">=</span><span class="s">"openstreetmap"</span><span class="p">)</span>
<span class="n">marker</span> <span class="o">=</span> <span class="n">folium</span><span class="p">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="s">"End Point Corporation"</span><span class="p">).</span><span class="n">add_to</span><span class="p">(</span><span class="n">fmap</span><span class="p">)</span>
<span class="n">fmap</span>
</code></pre></div></div>

<h3 id="tile-layers-basemaps">Tile layers (basemaps)</h3>
<p>The tile layer set represents a form of <code class="language-plaintext highlighter-rouge">raster</code>, a bitmap image that is 
shown on the root of the page. By default <code class="language-plaintext highlighter-rouge">folium</code> supports a number of 
<em>free</em> tile sets that can referenced by name, and which you can find examples
of here: <a href="https://leaflet-extras.github.io/leaflet-providers/preview/">https://leaflet-extras.github.io/leaflet-providers/preview/</a>. In addition
to the shortcut names for these tilemaps, they can be referenced in the form
of a URL like the following: <code class="language-plaintext highlighter-rouge">https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png</code>.</p>

<p>The format of a tile layer URL is that of a REST API. This is because tiles
are actually loaded dynamically by leaflet maps (and by other similar types
of map visualization tools like Google Maps). The <code class="language-plaintext highlighter-rouge">{s}</code> is the URL is for the
server name, the <code class="language-plaintext highlighter-rouge">{z}</code> is the level of zoom, and the <code class="language-plaintext highlighter-rouge">{x}</code> and <code class="language-plaintext highlighter-rouge">{y}</code> is for
the position on the globe. When you open a map, or change its zoom, or 
scroll to a new position on it, this triggers an event that will make a request
to the API to fetch new tiles.</p>

<p>The sets of free tile layers usually vary in providing more or less details on 
roads, colors, land categories, and labels, but some goofy ones exist as well, 
such as this metal-themed tile set. As you can see in this case an API key is 
required to show full details without an overlay. This requires registering 
with the host, and is usually associated with keeping track of your usage so 
that your account doesn’t hog all the request resources. As we’ll see later,
you can even generate and host your own tile sets.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fmap</span> <span class="o">=</span> <span class="n">folium</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> 
    <span class="n">zoom_start</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
    <span class="n">tiles</span><span class="o">=</span><span class="s">"https://{s}.tile.thunderforest.com/spinal-map/{z}/{x}/{y}.png"</span><span class="p">,</span>
    <span class="n">attr</span><span class="o">=</span><span class="s">"http://www.thunderforest.com"</span><span class="p">,</span>  <span class="c1"># the source of the tileset shown in the lower-right
</span>    <span class="n">API_key</span><span class="o">=</span><span class="s">'your.API.key'</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fmap</span>
</code></pre></div></div>

<div>
<iframe style="display: block; margin: auto; width:100%; height:400px; margin-top:2%;" src="./images/folium-2.html">
</iframe>
</div>

<h3 id="other-resources">Other resources</h3>

<p>Read more about what is possible with <code class="language-plaintext highlighter-rouge">folium</code> at the official documentation.
<a href="https://python-visualization.github.io/folium/index.html">folium docs</a></p>

<p>A similar alternative mapping tool that can be used in jupyter notebooks is
<a href="https://github.com/jupyter-widgets/ipyleaflet">ipyleaflet</a>.</p>

		</div>
	</main>

	<footer>
	    



<div class="container text-center mt-5">
	<p>Copyright &copy; 
	 <script>document.write( new Date().getFullYear() );</script> 
	 Deren Eaton
	 </p>
</div>


	    




<!-- JS: jQuery, Popper.js, and Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>

<script type="text/javascript">
	var BASE_URL = '';
</script>


	</footer>

</body>
</html>
